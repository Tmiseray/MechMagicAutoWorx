components:
  schemas:
    mechanic_ticket_services:
      type: object
      description: Association between MechanicTicket and Service, used to track services performed on a ticket
      required: [mechanic_ticket_id, service_id]
      properties:
        mechanic_ticket_id:
          type: integer
          description: ID of the associated MechanicTicket
        service_id:
          type: integer
          description: ID of the associated Service

    mechanic_ticket_items:
      type: object
      description: Association between MechanicTicket and ServiceItem, used to track inventory items used on a ticket
      required: [mechanic_ticket_id, service_item_id]
      properties:
        mechanic_ticket_id:
          type: integer
          description: ID of the associated MechanicTicket
        service_item_id:
          type: integer
          description: ID of the associated ServiceItem

    Customer:
      type: object
      required:
        - name
        - email
        - phone
      properties:
        id:
          type: integer
        name:
          type: string
          minLength: 1
          maxLength: 100
        email:
          type: string
          format: email
        phone:
          type: string
          minLength: 10
          maxLength: 100
        vehicles:
          type: array
          items:
            $ref: "#/components/schemas/Vehicle"
            exclude:
              - customer
              - customer_id
              - service_tickets
        account:
          $ref: "#/components/schemas/CustomerAccount"
          exclude:
            - customer
            - customer_id
        service_tickets:
          type: array
          items:
            $ref: "#/components/schemas/ServiceTicket"
            exclude:
              - customer
              - customer_id

    CustomerAccount:
      type: object
      required: [customer_id, email, password]
      properties:
        id:
          type: integer
        customer_id:
          type: integer
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8
        customer:
          $ref: "#/components/schemas/Customer"
          exclude:
            - account
            - id

    CustomerLogin:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8

    Invoice:
      type: object
      required: [paid, service_ticket_id]
      properties:
        id:
          type: integer
        invoice_date:
          type: string
          format: date
        total:
          type: number
          format: float
        paid:
          type: boolean
        service_ticket_id:
          type: integer
        service_ticket:
          $ref: "#/components/schemas/ServiceTicket"
          exclude:
            - invoice
            - id

    Vehicle:
      type: object
      required: [VIN, year, make, model, mileage]
      properties:
        VIN:
          type: string
          minLength: 17
          maxLength: 100
        year:
          type: integer
        make:
          type: string
          minLength: 1
          maxLength: 100
        model:
          type: string
          minLength: 1
          maxLength: 100
        mileage:
          type: integer
        customer_id:
          type: integer
        customer:
          $ref: "#/components/schemas/Customer"
        service_tickets:
          type: array
          items:
            $ref: "#/components/schemas/ServiceTicket"

    Mechanic:
      type: object
      required: [name, email, phone, salary]
      properties:
        id:
          type: integer
        name:
          type: string
          minLength: 1
          maxLength: 100
        email:
          type: string
          format: email
        phone:
          type: string
          minLength: 10
          maxLength: 100
        salary:
          type: number
          format: float
        account:
          $ref: "#/components/schemas/MechanicAccount"
        mechanic_tickets:
          type: array
          items:
            $ref: "#/components/schemas/MechanicTicket"

    MechanicAccount:
      type: object
      required: [mechanic_id, email, password]
      properties:
        id:
          type: integer
        role:
          type: string
          default: Mechanic
        mechanic_id:
          type: integer
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8
          maxLength: 100
        mechanic:
          $ref: "#/components/schemas/Mechanic"

    MechanicLogin:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8

    MechanicTicket:
      type: object
      required: [service_ticket_id]
      properties:
        id:
          type: integer
        start_date:
          type: string
          format: date
        end_date:
          type: string
          format: date
        hours_worked:
          type: number
          format: float
        service_ticket_id:
          type: integer
        service_ticket:
          $ref: "#/components/schemas/ServiceTicket"
        mechanic_id:
          type: integer
        mechanic:
          $ref: "#/components/schemas/Mechanic"
        services:
          type: array
          items:
            $ref: "#/components/schemas/mechanic_ticket_services"
        additional_items:
          type: array
          items:
            $ref: "#/components/schemas/mechanic_ticket_items"

    Inventory:
      type: object
      required: [name, stock, price]
      properties:
        id:
          type: integer
        name:
          type: string
          minLength: 1
          maxLength: 100
        stock:
          type: integer
          minimum: 0
        price:
          type: number
          format: float
        service_items:
          type: array
          items:
            $ref: "#/components/schemas/ServiceItem"

    ServiceItem:
      type: object
      required: [item_id, quantity]
      properties:
        id:
          type: integer
        item_id:
          type: integer
        inventory:
          $ref: "#/components/schemas/Inventory"
        service_id:
          type: integer
        service:
          $ref: "#/components/schemas/Service"
        quantity:
          type: integer
          minimum: 1
        mechanic_tickets:
          type: array
          items:
            $ref: "#/components/schemas/mechanic_ticket_items"

    Service:
      type: object
      required: [name, price]
      properties:
        id:
          type: integer
        name:
          type: string
          minLength: 1
          maxLength: 100
        price:
          type: number
          format: float
        service_items:
          type: array
          items:
            $ref: "#/components/schemas/ServiceItem"
        mechanic_tickets:
          type: array
          items:
            $ref: "#/components/schemas/mechanic_ticket_services"

    ServiceTicket:
      type: object
      required: [service_desc, VIN]
      properties:
        id:
          type: integer
        service_date:
          type: string
          format: date
        service_desc:
          type: string
          minLength: 1
          maxLength: 255
        VIN:
          type: string
        vehicle:
          $ref: "#/components/schemas/Vehicle"
        customer_id:
          type: integer
        customer:
          $ref: "#/components/schemas/Customer"
        mechanic_tickets:
          type: array
          items:
            $ref: "#/components/schemas/MechanicTicket"
        invoice:
          $ref: "#/components/schemas/Invoice"

